//The nPose scripts are licensed under the GPLv2 (http:/|/www.gnu.org/licenses/gpl-2.0.txt), with the following addendum:

//The nPose scripts are free to be copied, modified, and redistributed, subject to the following conditions:
//    - If you distribute the nPose scripts, you must leave them full perms.
//    - If you modify the nPose scripts and distribute the modifications, you must also make your modifications full perms.

//"Full perms" means having the modify, copy, and transfer permissions enabled in Second Life and/or other virtual world platforms derived from Second Life (such as OpenSim).  If the platform should allow more fine-grained permissions, then "full perms" will mean the most permissive possible set of permissions allowed by the platform.

integer gPLUGIN_COMMAND_REGISTER    = 310;
integer gCMD_SET_CHAINS = 2732; // cmdId, set chains in msg
integer gCMD_REM_CHAINS = 2733; // cmdId, remove all chains
integer gCMD_CONFIG     = 2734; // cmdId, config in msg

default {
    state_entry() {
        llMessageLinked(LINK_SET, gPLUGIN_COMMAND_REGISTER, llDumpList2String(["CHAINS_ADD", gCMD_SET_CHAINS, 1, 0], "|"), "");
        llMessageLinked(LINK_SET, gPLUGIN_COMMAND_REGISTER, llDumpList2String(["CHAINS_REMOVE", gCMD_REM_CHAINS, 1, 0], "|"), "");
        llMessageLinked(LINK_SET, gPLUGIN_COMMAND_REGISTER, llDumpList2String(["CHAINS_CONFIG", gCMD_CONFIG, 1, 0], "|"), "");
    }
    link_message(integer sender, integer num, string str, key id) {
        if (num == gCMD_SET_CHAINS || num == gCMD_REM_CHAINS || num == gCMD_CONFIG) {
            list params = llParseStringKeepNulls(str, ["|"], []);
            llRegionSayTo((key)llList2String(params, 1), num, llList2String(params, 0) + "|" + llList2String(params, 1));
        }
    }
    
    on_rez(integer params) {llResetScript();}
}
